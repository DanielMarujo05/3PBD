SELECT Nome 
FROM EMPREGADO 
WHERE Depto = (SELECT Numero FROM DEPARTAMENTO WHERE Nome = 'Engenharia Civil');

SELECT PROJETO.Numero AS Projeto_Numero, 
       DEPARTAMENTO.Numero AS Departamento_Numero, 
       EMPREGADO.Nome AS Gerente_Nome
FROM PROJETO
JOIN DEPARTAMENTO_PROJETO ON PROJETO.Numero = DEPARTAMENTO_PROJETO.Numero_Projeto
JOIN DEPARTAMENTO ON DEPARTAMENTO.Numero = DEPARTAMENTO_PROJETO.Numero_Depto
JOIN EMPREGADO ON DEPARTAMENTO.RG_Gerente = EMPREGADO.RG
WHERE PROJETO.Localizacao = 'SÃ£o Paulo';

SELECT *
FROM EMPREGADO E
WHERE NOT EXISTS (
    SELECT 1 
    FROM DEPARTAMENTO_PROJETO DP
    WHERE DP.Numero_Depto = 3
    AND NOT EXISTS (
        SELECT 1 
        FROM EMPREGADO_PROJETO EP
        WHERE EP.RG_Empregado = E.RG 
        AND EP.Numero_Projeto = DP.Numero_Projeto
    )
);

SELECT DISTINCT Numero_Projeto
FROM EMPREGADO_PROJETO
WHERE RG_Empregado = (SELECT RG FROM EMPREGADO WHERE Nome = 'Fernando')
UNION
SELECT Numero_Projeto
FROM DEPARTAMENTO_PROJETO
WHERE Numero_Depto = (SELECT Depto FROM EMPREGADO WHERE Nome = 'Fernando');

SELECT Nome 
FROM EMPREGADO
WHERE RG NOT IN (SELECT RG_Responsavel FROM DEPENDENTES);

SELECT DISTINCT E.Nome
FROM EMPREGADO E
JOIN DEPARTAMENTO D ON E.RG = D.RG_Gerente
WHERE E.RG IN (SELECT RG_Responsavel FROM DEPENDENTES);

SELECT DISTINCT Numero_Depto
FROM DEPARTAMENTO_PROJETO DP
JOIN PROJETO P ON DP.Numero_Projeto = P.Numero
WHERE P.Localizacao = 'Rio Claro';

SELECT DISTINCT E.Nome, E.RG
FROM EMPREGADO E
WHERE E.RG IN (SELECT RG_Supervisor FROM EMPREGADO);

SELECT * 
FROM EMPREGADO
WHERE Salario >= 2000;

SELECT * 
FROM EMPREGADO
WHERE Nome LIKE 'J%';

SELECT * 
FROM EMPREGADO
WHERE Nome LIKE '%Luiz%' OR Nome LIKE '%Luis%';

SELECT * 
FROM EMPREGADO
WHERE Depto = (SELECT Numero FROM DEPARTAMENTO WHERE Nome = 'Engenharia Civil');

SELECT DISTINCT D.Nome
FROM DEPARTAMENTO D
JOIN DEPARTAMENTO_PROJETO DP ON D.Numero = DP.Numero_Depto
JOIN PROJETO P ON DP.Numero_Projeto = P.Numero
WHERE P.Nome = 'Motor 3';

SELECT DISTINCT E.Nome
FROM EMPREGADO E
JOIN EMPREGADO_PROJETO EP ON E.RG = EP.RG_Empregado
JOIN PROJETO P ON EP.Numero_Projeto = P.Numero
WHERE P.Nome = 'Financeiro 1';

SELECT *
FROM EMPREGADO
WHERE RG_Supervisor IN (
    SELECT RG
    FROM EMPREGADO
    WHERE Salario BETWEEN 2000 AND 2500
);

SELECT DISTINCT E.Nome
FROM EMPREGADO E
JOIN DEPARTAMENTO D ON E.RG = D.RG_Gerente
WHERE E.RG IN (SELECT RG_Responsavel FROM DEPENDENTES);

UPDATE EMPREGADO
SET Salario = 3000
WHERE Depto = 2;

UPDATE EMPREGADO
SET Salario = Salario * 1.10;

SELECT AVG(Salario) AS Media_Salarial
FROM EMPREGADO;

SELECT Nome
FROM EMPREGADO
WHERE Salario > (SELECT AVG(Salario) FROM EMPREGADO)
ORDER BY Nome;
